machine:
  python:
    version: 2.7.11

dependencies:
  override:
    - echo "dependencies"
test:
  override:
    - |
      git clone git://github.com/scikit-build/scikit-ci-addons -b add-addon-ctest-to-junit
    - |
      pip install -r ./scikit-ci-addons/requirements.txt
      pip install ./scikit-ci-addons
    - |
      mkdir -p ${CIRCLE_TEST_REPORTS}/junit
      ci_addons ctest_junit_formatter $(pwd) > ${CIRCLE_TEST_REPORTS}/junit/BaseTest.xml

deployment:
  nightly:
    branch: master
    owner: jcfr
    commands:
      - echo "deployment-nightly"
  release:
    tag: /v[0-9]+\.[0-9]+\.[0-9]+/
    owner: jcfr
    commands:
      - echo "deployment-release"
